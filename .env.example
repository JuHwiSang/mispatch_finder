# Mispatch Finder Configuration
# Copy this file to .env and fill in your values

# ============================================================================
# REQUIRED CONFIGURATION
# ============================================================================

# GitHub Personal Access Token
# Required for accessing GitHub Security Advisories and repository data
# Get your token at: https://github.com/settings/tokens
# Required scopes: public_repo (or repo for private repos)
MISPATCH_FINDER_GITHUB__TOKEN=ghp_your_token_here

# LLM API Key
# Required for analysis (OpenAI or Anthropic)
# OpenAI: https://platform.openai.com/api-keys
# Anthropic: https://console.anthropic.com/settings/keys
MISPATCH_FINDER_LLM__API_KEY=your_api_key_here


# ============================================================================
# OPTIONAL CONFIGURATION (with defaults)
# ============================================================================

# LLM Provider Configuration
# ----------------------------------------------------------------------------

# LLM Provider Name
# Options: "openai", "anthropic"
# Default: "openai"
MISPATCH_FINDER_LLM__PROVIDER_NAME=openai

# LLM Model Name
# OpenAI models: "gpt-4o", "gpt-4o-mini", "gpt-4-turbo"
# Anthropic models: "claude-sonnet-4", "claude-opus-4", "claude-haiku-4"
# Default: "gpt-4o"
MISPATCH_FINDER_LLM__MODEL_NAME=gpt-4o


# Vulnerability Configuration
# ----------------------------------------------------------------------------

# Default Ecosystem Filter
# Options: "npm", "pypi", "go", "maven", "nuget", "cargo", "composer", etc.
# Leave empty to disable ecosystem filtering
# Default: "npm"
MISPATCH_FINDER_VULNERABILITY__ECOSYSTEM=npm

# Vulnerability Filter Expression
# Python expression to filter vulnerabilities
# Available fields: stars, size_bytes, severity, ecosystem
# Examples:
#   - "stars >= 100"
#   - "severity == 'CRITICAL'"
#   - "stars >= 100 and size_bytes <= 10_000_000"
#   - "" (empty string to disable filtering)
# Default: "stars is not None and stars>=100 and size_bytes is not None and size_bytes<=10_000_000"
MISPATCH_FINDER_VULNERABILITY__FILTER_EXPR="stars is not None and stars>=100 and size_bytes is not None and size_bytes<=10_000_000"


# Analysis Configuration
# ----------------------------------------------------------------------------

# Maximum Diff Characters
# Maximum number of characters in diff sent to LLM
# Larger diffs will be truncated
# Default: 200000 (200K characters)
MISPATCH_FINDER_ANALYSIS__DIFF_MAX_CHARS=200000

# MCP Server Port
# Port number for MCP server (used in streamable-http mode)
# Default: 18080
MISPATCH_FINDER_ANALYSIS__MCP_PORT=18080


# Directory Configuration
# ----------------------------------------------------------------------------

# Base Directory
# Base directory for all data (repositories, logs, cache)
# If not set, uses platform-specific cache directory:
#   - Windows: %LOCALAPPDATA%\mispatch-finder
#   - macOS: ~/Library/Caches/mispatch-finder
#   - Linux: ~/.cache/mispatch-finder
# Default: platform-specific cache directory
# MISPATCH_FINDER_DIRECTORIES__HOME=/path/to/custom/directory


# Logging Configuration
# ----------------------------------------------------------------------------

# Log Level
# Options: "DEBUG", "INFO", "WARNING", "ERROR", "CRITICAL"
# Default: "INFO"
MISPATCH_FINDER_LOGGING__LEVEL=INFO

# Console Output
# Enable/disable console output (in addition to file logging)
# CLI commands automatically enable this
# Default: False
MISPATCH_FINDER_LOGGING__CONSOLE_OUTPUT=False


# ============================================================================
# ADVANCED CONFIGURATION
# ============================================================================

# GitHub Configuration
# ----------------------------------------------------------------------------

# GitHub API Base URL
# Override if using GitHub Enterprise
# Default: "https://api.github.com"
# MISPATCH_FINDER_GITHUB__BASE_URL=https://api.github.com


# Git Configuration
# ----------------------------------------------------------------------------

# Git Clone Timeout (seconds)
# Timeout for git clone operations
# Default: 300 (5 minutes)
# MISPATCH_FINDER_GIT__CLONE_TIMEOUT=300


# Runtime Configuration (DO NOT SET - managed by CLI)
# ----------------------------------------------------------------------------
# These are set programmatically by the CLI and should not be configured:
# MISPATCH_FINDER_RUNTIME__GHSA=GHSA-xxxx-xxxx-xxxx
